<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÂúãÂÆ∂Áü•Ë≠òÁéã: 7 Continents123</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DotGothic16&family=Arial+Black&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: "DotGothic16", "PMingLiU", monospace;
            background-color: #008080;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            overflow: hidden;
            cursor: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAGFBMVEUAAAAAAACAgIAAAADAwMD/AAAA////AAD3+P2XAAAACHRSTlMA/////////wDDC+u1AAAAWklEQVR42mNgwA0YgOABhAGhYQBJmEA0TBCbIkwgmibIpgk3jKyIYAJVERQTVBVgQ1AVoStC14SqCMMQwhB0RRhG0BThGIIqgusIoSgiM0QoitAVUUAhQJp5AABIEwIjW9eJ3gAAAABJRU5ErkJggg=='), auto;
        }

        button, .option, .score-btn {
            cursor: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAGFBMVEUAAAAAAACAgIAAAAAAAAD/AAD/AAAA//8v/6HgAAAAB3RSTlMA////////AM4A0a8AAABoSURBVDjL7dChFgAhCETRi/3/v3yFhCSzbwayqs15kCX89Ec8F3yGg884+IyDzzj4jIPPOPiMg884+IyDzzj4jIPPOPiMg884+IyDzzj4jIPPOPiMg884+LwB910C9xL/q7EAAAAASUVORK5CYII='), pointer;
        }

        /* === 1. ‰∏ªË¶ñÁ™ó === */
        .window {
            background-color: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(20px) saturate(125%);
            -webkit-backdrop-filter: blur(20px) saturate(125%);
            border: 1px solid rgba(255, 255, 255, 0.6);
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15), 
                        0 0 0 1px rgba(0, 0, 0, 0.05); 
            width: 95vw;
            height: 92vh;
            display: flex;
            flex-direction: column;
            position: relative;
            z-index: 1;
            overflow: hidden;
            color: #333;
        }

        /* === 2. Ê®ôÈ°åÂàó === */
        .title-bar {
            background: transparent;
            padding: 12px 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-shrink: 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        .title-bar-text {
            color: #202020;
            font-weight: 600;
            font-size: 14px;
            letter-spacing: 0.5px;
            font-family: "Segoe UI", "Microsoft JhengHei", sans-serif;
        }

        .title-bar-controls button {
            background: transparent;
            border: none;
            color: #333;
            width: 32px;
            height: 32px;
            border-radius: 4px;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.2s;
            margin-left: 4px;
        }

        .title-bar-controls button:hover {
            background-color: rgba(0, 0, 0, 0.05);
        }

        .title-bar-controls button:last-child:hover {
            background-color: #e81123;
            color: white;
        }

        /* === 3. ÂÖßÂÆπÂçÄÂüü === */
        .content-area {
            background-color: rgba(240, 243, 249, 0.5);
            flex-grow: 1;
            overflow-y: auto;
        }

        /* --- Style 1: Ê•µÁ∞°Â§ßÂ≠óÂ†± (Áî®Êñº Start Page) --- */
        .art-type-container {
            width: 100%;
            height: 80%;
            background-color: #222; 
            display: flex;
            justify-content: center;
            align-items: center;
            border: 4px solid #fff;
            box-shadow: 10px 10px 0 rgba(0,0,0,0.25);
            overflow: hidden;
            position: relative;
            transition: transform 0.3s;
        }

        .art-type-container:hover {
            transform: scale(1.02);
        }

        .art-type-text {
            font-family: 'Arial Black', 'Impact', sans-serif;
            font-size: clamp(3rem, 10vh, 8rem);
            line-height: 0.8;
            color: transparent;
            -webkit-text-stroke: 2px #fff; 
            writing-mode: vertical-rl; 
            text-orientation: upright;
            letter-spacing: -5px;
            opacity: 0.9;
            user-select: none;
        }

        .art-type-container::after {
            content: '';
            position: absolute;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent 40%, rgba(255,255,255,0.1) 50%, transparent 60%);
            animation: shine 4s infinite;
            pointer-events: none;
        }

        @keyframes shine {
            0% { transform: translate(-50%, -50%) rotate(0deg); }
            100% { transform: translate(-50%, -50%) rotate(360deg); }
        }

        /* --- Style 3: Áèæ‰ª£Âπæ‰Ωï (Áî®Êñº Home Page) --- */
        .art-geo-container {
            width: 100%;
            height: 80%;
            background-color: #f4f1ea; 
            border: 4px solid #222;
            box-shadow: 10px 10px 0 rgba(0,0,0,0.8);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .shape {
            position: absolute;
            border: 3px solid #222;
            transition: all 0.5s ease;
        }

        .shape-circle {
            width: 12vh; height: 12vh;
            border-radius: 50%;
            background: #d32f2f;
            top: 10%; left: -10%;
        }
        .shape-rect {
            width: 40%; height: 60%;
            background: #1976d2;
            bottom: 5%; right: 10%;
            z-index: 1;
        }
        .shape-line {
            width: 150%; height: 15px;
            background: #fbc02d;
            transform: rotate(-45deg);
            top: 50%; left: -20%;
            z-index: 2;
            border: none; border-top: 3px solid #222; border-bottom: 3px solid #222;
        }

        .shape-tri {
            width: 0; height: 0;
            border-left: 8vh solid transparent;
            border-right: 8vh solid transparent;
            border-bottom: 14vh solid #222;
            top: 20%; left: 50%;
            transform: translateX(-50%);
            background: transparent;
            border-top: none;
        }
        .shape-grid {
            width: 80%; height: 30%;
            background-image: radial-gradient(#222 20%, transparent 20%);
            background-size: 10px 10px;
            bottom: 15%; left: 10%;
            border: none;
        }
        .shape-float {
            width: 5vh; height: 5vh;
            background: #fbc02d;
            border-radius: 50%;
            top: 55%; right: 20%;
            animation: floatGeo 3s ease-in-out infinite alternate;
        }

        @keyframes floatGeo {
            from { transform: translateY(0); }
            to { transform: translateY(-20px); }
        }

        .title-wrapper {
            display: flex;
            align-items: flex-end; 
            justify-content: center;
            gap: 15px;
            margin-bottom: 10px; 
            height: 100px; 
        }

        h1 { 
            color: #000; 
            text-shadow: 3px 3px #808080;
            font-family: "DotGothic16", "Arial Black", sans-serif;
            font-size: 4em;
            letter-spacing: -2px;
            margin: 0; 
            line-height: 1;
            align-self: center; 
        }

        .avatar-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }

        .title-icon {
            height: 80px;
            width: auto;
            filter: drop-shadow(3px 3px 3px rgba(0,0,0,0.3));
            z-index: 2;
            transform-origin: center left;
            animation: flag-wave 2s ease-in-out infinite alternate;
            border: 2px solid #fff;
        }

        .avatar-container.right .title-icon {
            transform-origin: center right;
            animation-delay: -1s;
        }

        @keyframes flag-wave {
            0% { transform: rotate(0deg) skewY(0deg); }
            100% { transform: rotate(3deg) skewY(2deg); }
        }
        
        .subtitle { 
            background: #fff; border: inset 3px; padding: 5px 20px; 
            margin-bottom: 20px; display: inline-block; color: #000; font-size: 1.2em;
        }

        .btn {
            background-color: #c0c0c0; color: #000;
            border: 3px solid #fff; border-right-color: #404040; border-bottom-color: #404040;
            padding: 10px 20px; text-align: center; font-size: 1.5em; margin: 10px;
            cursor: pointer; font-family: "DotGothic16", inherit;
            box-shadow: 2px 2px 0 #000; min-width: 250px;
        }

        .btn:active {
            border: 3px solid #404040; border-right-color: #fff; border-bottom-color: #fff;
            transform: translate(2px, 2px);
        }

        .btn-category { 
            font-weight: bold; 
            font-size: 2.2em; 
            width: 320px;      
            margin: 10px; 
        }
        
        .btn-question { width: 100px; height: 100px; font-size: 2.5em; font-weight: bold; margin: 10px; }
        .btn-question.visited {
            background-color: #a0a0a0;
            border: 2px solid #808080; border-right-color: #fff; border-bottom-color: #fff;
            color: #505050; box-shadow: none; border-style: inset;
        }

        .btn-home { width: auto; font-size: 1.2em; margin-top: 15px; background-color: #a0a0a0; padding: 8px 15px; }
        .btn-start { font-size: 2.5em; font-weight: bold; margin-top: 15px; background-color: #d0d0d0;}
        .btn-settle { background-color: #E91E63; color: white; border: 3px outset #ff80ab; width: auto; font-size: 1.2em; padding: 5px 15px; }
        .btn-settle:active { border-style: inset; }

        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 10px 0; width: 90%; }
        .option { background: #fff; padding: 15px; border: inset 3px; font-size: 2.2em; cursor: pointer; text-align: left; display: flex; align-items: center; }
        .correct-answer { background-color: #000080 !important; color: #fff !important; animation: blink 0.5s step-end infinite alternate; }
        @keyframes blink { 50% { background-color: #ff00ff !important; color: yellow !important; } }

        .page { display: none; width: 100%; height: 100%; justify-content: center; align-items: center; flex-direction: column; }
        .page.active { display: flex; }

        .rules-box {
            background: #fff; border: 3px inset #dfdfdf; padding: 10px 20px;
            text-align: left; width: 70%; max-width: 800px; margin: 5px 0;
            font-size: 1.3em; line-height: 1.3; box-shadow: inset 2px 2px 5px rgba(0,0,0,0.2);
        }
        .rules-box h3 { margin-top: 5px; color: #000080; border-bottom: 2px solid #c0c0c0; padding-bottom: 5px; margin-bottom: 5px; }
        .rules-list li { margin-bottom: 5px; }

        .home-layout { flex-direction: row !important; justify-content: center; align-items: center; gap: 5%; padding: 0 20px; width: 100%; box-sizing: border-box; }
        .illustration-col { flex: 1; display: flex; justify-content: center; align-items: center; max-width: 21%; height: 100%; }
        
        .center-content { flex: 3; display: flex; flex-direction: column; align-items: center; z-index: 10; padding: 0 5px; max-width: 1400px; }
        #category-list { display: flex; flex-wrap: wrap; justify-content: center; width: 100%; }

        .score-box { background: #000; color: #0f0; padding: 5px 30px; font-family: monospace; border: inset 4px; margin-bottom: 10px; font-size: 3em; font-weight: bold; box-shadow: 0 0 10px #0f0; }
        
        #q-text { 
            font-size: clamp(1.5em, 4vw, 2.6em);
            margin: 5px 0; 
            line-height: 1.3; 
            width: 100%; 
            white-space: normal; 
            word-wrap: break-word; 
            overflow: visible;   
        }
        
        .taskbar { 
            background-color: #c0c0c0; 
            border-top: 2px solid #fff; 
            padding: 5px 10px; 
            display: flex; 
            justify-content: space-evenly; 
            align-items: center; 
            height: 90px;
            flex-shrink: 0; 
            box-shadow: 0 -2px 5px rgba(0,0,0,0.2); 
            z-index: 100; 
            overflow-x: auto;
        }
        .team-score { 
            background: #dfdfdf; 
            border: 2px inset #fff; 
            padding: 3px 5px; 
            display: flex; 
            align-items: center; 
            gap: 5px; 
            border-radius: 4px;
            margin: 0 2px;
            flex-shrink: 0;
        }
        .team-name { 
            font-weight: bold; 
            font-size: 1.1em;
            color: #000080; 
            white-space: nowrap;
        }
        .score-display { 
            font-family: monospace; 
            font-size: 1.8em; 
            background: #000; 
            color: red; 
            padding: 0 5px; 
            min-width: 40px; 
            text-align: right; 
            border: 2px inset #808080; 
        }
        .score-btn { 
            width: 30px;
            height: 30px; 
            font-size: 18px; 
            font-weight: bold; 
            line-height: 26px; 
            text-align: center; 
            padding: 0; 
            background: #c0c0c0; 
            border: 2px outset #fff; 
            cursor: pointer; 
        }
        .score-btn:active { border-style: inset; } .score-btn.minus { color: red; } .score-btn.plus { color: green; }

        #matrix-canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 2000; display: none; pointer-events: none; }
        #wipe-overlay { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 2001; transform: scaleY(0); transform-origin: top; transition: transform 0.5s ease-in-out; pointer-events: none; }
        .wipe-active { transform: scaleY(1) !important; }

        #loading-text { position: absolute; top: 20px; left: 20px; color: #0f0; font-family: "DotGothic16", monospace; font-size: 2em; display: none; z-index: 2002; }

        #leaderboard-content { background: #fff; border: 4px double #000080; padding: 40px; text-align: center; width: 80%; max-width: 600px; box-shadow: 10px 10px 0 rgba(0,0,0,0.5); position: relative; z-index: 1000; }
        .trophy { font-size: 100px; display: block; margin-bottom: 20px; }
        .winner-text { color: #d50000; font-size: 3em; font-weight: bold; animation: blink 0.5s infinite; word-wrap: break-word; } 
        .rank-list { font-size: 1.5em; text-align: left; margin-top: 30px; border-top: 2px solid #ccc; padding-top: 20px; }
        .rank-item { display: flex; justify-content: space-between; margin-bottom: 10px; border-bottom: 1px dotted #ccc; }

        @media (max-aspect-ratio: 16/10) {
            .illustration-col { max-width: 15%; }
            .center-content { width: 70%; padding: 0 5px; }
            #page-start .illustration-col:first-child .pixel-img,
            #page-start .illustration-col:last-child .pixel-img { transform: scale(1.1); }
            h1 { font-size: 3em; }
            .rules-box { font-size: 1.2em; width: 85%; }
            .title-icon { height: 60px; }
            .title-wrapper { height: 80px; }
            
            .art-type-text { font-size: 4rem; }
            .team-name { display: none; }
            .score-btn { width: 25px; height: 25px; font-size: 16px; }
        }
    </style>
</head>
<body>

<div class="window" id="main-window">
    <div class="title-bar">
        <div class="title-bar-text" id="win-title">World_Map.exe</div>
        <div class="title-bar-controls">
            <button>_</button>
            <button id="fs-btn" onclick="toggleFullscreen()">‚ñ°</button> 
            <button>X</button>
        </div>
    </div>
    
    <div class="content-area">
        
        <canvas id="matrix-canvas"></canvas>
        <div id="wipe-overlay">
            <div id="loading-text">Loading</div>
        </div>

        <div id="page-start" class="page active home-layout">
            <div class="illustration-col">
                <div class="art-type-container">
                    <div class="art-type-text" style="-webkit-text-stroke: 0; color: #fff;">WORLD</div>
                </div>
            </div>
            <div class="center-content">
                
                <div class="title-wrapper">
                    <div class="avatar-container">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/7/72/Flag_of_the_Republic_of_China.svg" alt="Âè∞ÁÅ£ÂúãÊóó" class="title-icon">
                    </div>
                    <h1>ÂúãÂÆ∂Áü•Ë≠òÁéã</h1>
                    <div class="avatar-container right">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/0/03/Flag_of_Italy.svg" alt="Áæ©Â§ßÂà©ÂúãÊóó" class="title-icon">
                    </div>
                </div>

                <div class="subtitle">>>> System Loading: 7 Continents <<<</div>
                <div class="rules-box">
                    <h3>‚â° ÈÅäÊà≤Ë¶èÂâáË™™Êòé ‚â°</h3>
                    <ul class="rules-list">
                        <li>ÂÄã‰∫∫Êà∞Ôºö6 ‰ΩçÈÅ∏ÊâãËº™ÊµÅÊàñÊê∂Á≠î„ÄÇ</li>
                        <li>ÁØÑÂúçÊ∂µËìãÔºö‰∫û„ÄÅÊ≠ê„ÄÅÈùû„ÄÅÂåóÁæé„ÄÅÂçóÁæé„ÄÅÂ§ßÊ¥ã„ÄÅÂçóÊ•µ„ÄÇ</li>
                        <li>ÊâÄÊúâÈ°åÁõÆÁöÜÁÇ∫ 1 ÂàÜÔºåÊúÄÁµÇÁ©çÂàÜÊúÄÈ´òËÄÖÁç≤Âãù„ÄÇ</li>
                        <li>Ë´ãÂãø‰ΩøÁî®ÊâãÊ©ü Google Á≠îÊ°àÔºÅ</li>
                    </ul>
                </div>
                <button class="btn btn-start" onclick="startGame()">ÈñãÂßãÈÅäÊà≤_Start</button>
            </div>
            <div class="illustration-col">
                <div class="art-type-container" style="background-color: #E91E63;">
                    <div class="art-type-text">QUIZ</div>
                </div>
            </div>
        </div>
        
        <div id="page-home" class="page home-layout">
            <div class="illustration-col">
                <div class="art-geo-container">
                    <div class="shape shape-circle"></div>
                    <div class="shape shape-rect"></div>
                    <div class="shape shape-line"></div>
                </div>
            </div>
            <div class="center-content">
                
                <div class="title-wrapper">
                    <div class="avatar-container">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/e/ea/Flag_of_Monaco.svg" alt="Êë©Á¥çÂì•" class="title-icon">
                    </div>
                    <h1>‰∏ÉÂ§ßÊ¥≤ÊåëÊà∞</h1>
                    <div class="avatar-container right">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/b/b9/Flag_of_Australia.svg" alt="Êæ≥Ê¥≤" class="title-icon">
                    </div>
                </div>

                <div class="subtitle">>>> Select Continent <<<</div>
                <div id="category-list"></div>
            </div>
            <div class="illustration-col">
                <div class="art-geo-container">
                    <div class="shape shape-tri"></div>
                    <div class="shape shape-float"></div>
                    <div class="shape shape-grid"></div>
                </div>
            </div>
        </div>

        <div id="page-selection" class="page">
            <h2 id="selection-title" style="border-bottom: 4px solid #808080; padding-bottom: 15px; font-size: 2.5em;">ÈÅ∏ÊìáÈ°åÁõÆ</h2>
            <div id="question-list" style="display: flex; flex-wrap: wrap; justify-content: center;"></div>
            <button class="btn btn-home" onclick="goHomeWithMatrix()">Âõû‰∏ªÈÅ∏ÂñÆ (ESC)</button>
        </div>

        <div id="page-question" class="page">
            <div class="score-box">Êú¨È°å: <span id="q-score">0</span> ÂàÜ</div>
            
            <div id="question-content-area" style="width: 80%; text-align: center;"></div>
            <div class="options-grid" id="q-options"></div>
            
            <div id="short-answer-text" class="short-answer-display" style="display:none; font-size: 2.5em; color: #d50000; font-weight: bold; background: #fff; padding: 10px; border: 3px solid #000;"></div>

            <div>
                <button id="reveal-btn" class="btn" style="background:#E0E0E0; color: #b22222; font-weight:bold;" onclick="revealAnswer()">ÁúãÁ≠îÊ°à</button>
                <button class="btn btn-home" onclick="goBackToSelection()">ËøîÂõû</button>
            </div>
        </div>

        <div id="page-leaderboard" class="page">
            <div id="leaderboard-content">
                <span class="trophy">üèÜ</span>
                <h2>WE ARE THE CHAMPION</h2>
                <div id="winner-display" class="winner-text"></div>
                <div class="rank-list" id="rank-list"></div>
                <button class="btn btn-home" onclick="restartGame()">ÈáçÊñ∞ÈñãÂßã</button>
            </div>
        </div>

    </div>

    <div class="taskbar">
        <div class="team-score">
            <span class="team-name">Ë¨ùÊ≤õËÆå</span>
            <button class="score-btn minus" onclick="updateScore(1, -1)">-</button>
            <div class="score-display" id="score-player-1">0</div>
            <button class="score-btn plus" onclick="updateScore(1, 1)">+</button>
        </div>
        <div class="team-score">
            <span class="team-name">Ëî°ÁâßË¨ô</span>
            <button class="score-btn minus" onclick="updateScore(2, -1)">-</button>
            <div class="score-display" id="score-player-2">0</div>
            <button class="score-btn plus" onclick="updateScore(2, 1)">+</button>
        </div>
        <div class="team-score">
            <span class="team-name">Âê≥ËªçÊÖß</span>
            <button class="score-btn minus" onclick="updateScore(3, -1)">-</button>
            <div class="score-display" id="score-player-3">0</div>
            <button class="score-btn plus" onclick="updateScore(3, 1)">+</button>
        </div>
        <div class="team-score">
            <span class="team-name">Âê≥Â≤±ÂÄ´</span>
            <button class="score-btn minus" onclick="updateScore(4, -1)">-</button>
            <div class="score-display" id="score-player-4">0</div>
            <button class="score-btn plus" onclick="updateScore(4, 1)">+</button>
        </div>
        <div class="team-score">
            <span class="team-name">Èô≥ÊñáË±´</span>
            <button class="score-btn minus" onclick="updateScore(5, -1)">-</button>
            <div class="score-display" id="score-player-5">0</div>
            <button class="score-btn plus" onclick="updateScore(5, 1)">+</button>
        </div>
        <div class="team-score">
            <span class="team-name">Èô≥ÊÄ°Èúñ</span>
            <button class="score-btn minus" onclick="updateScore(6, -1)">-</button>
            <div class="score-display" id="score-player-6">0</div>
            <button class="score-btn plus" onclick="updateScore(6, 1)">+</button>
        </div>
        
        <button class="btn btn-settle" onclick="showLeaderboard()">ÁµêÁÆó</button>
    </div>

</div>

<script>
    const SoundSystem = {
        ctx: null,
        init: function() {
            if (!this.ctx) {
                this.ctx = new (window.AudioContext || window.webkitAudioContext)();
            }
        },
        playTone: function(freq, type, duration, vol = 0.1, startTime = 0) {
            if (!this.ctx) return;
            const osc = this.ctx.createOscillator();
            const gain = this.ctx.createGain();
            osc.type = type;
            osc.frequency.setValueAtTime(freq, this.ctx.currentTime + startTime);
            gain.gain.setValueAtTime(0, this.ctx.currentTime + startTime);
            gain.gain.linearRampToValueAtTime(vol, this.ctx.currentTime + startTime + 0.02);
            gain.gain.exponentialRampToValueAtTime(0.01, this.ctx.currentTime + startTime + duration);
            osc.connect(gain);
            gain.connect(this.ctx.destination);
            osc.start(this.ctx.currentTime + startTime);
            osc.stop(this.ctx.currentTime + startTime + duration);
        },
        playHover: function() { this.playTone(800, 'square', 0.05, 0.02); }, 
        playClick: function() { this.playTone(600, 'square', 0.1, 0.05); }, 
        playDataNoise: function() { 
            if (!this.ctx) return;
            const bufferSize = this.ctx.sampleRate * 0.3; 
            const buffer = this.ctx.createBuffer(1, bufferSize, this.ctx.sampleRate);
            const data = buffer.getChannelData(0);
            for (let i = 0; i < bufferSize; i++) data[i] = Math.random() * 2 - 1;
            const noise = this.ctx.createBufferSource();
            noise.buffer = buffer;
            const gain = this.ctx.createGain();
            gain.gain.value = 0.05;
            noise.connect(gain);
            gain.connect(this.ctx.destination);
            noise.start();
        },
        playCoin: function() { 
            this.playTone(987, 'square', 0.1, 0.1, 0); 
            this.playTone(1318, 'square', 0.4, 0.1, 0.1); 
        }
    };

    // === ‰∏ÉÂ§ßÊ¥≤È°åÁõÆË≥áÊñô (ÂêÑ 10 È°å) ===
    const gameData = [
        {
            category: "‰∫ûÊ¥≤ (Asia)",
            questions: [
                {
                    text: "‰∏ñÁïå‰∏äÊµ∑ÊãîÊúÄÈ´òÁöÑÂ±±Â≥∞„ÄåËÅñÊØçÂ≥∞„Äç‰ΩçÊñºÂì™ÂÖ©ÂÄãÂúãÂÆ∂ÁöÑÈÇäÁïåÔºü",
                    options: ["A. ‰∏≠ÂúãËàáÂç∞Â∫¶", "B. Âç∞Â∫¶ËàáÂ∑¥Âü∫ÊñØÂù¶", "C. ‰∏≠ÂúãËàáÂ∞ºÊ≥äÁàæ", "D. Â∞ºÊ≥äÁàæËàá‰∏ç‰∏π"],
                    correctIndex: 2,
                    score: 1
                },
                {
                    text: "‰∏ãÂàóÂì™ÂÄãÂúãÂÆ∂Ë¢´Á®±ÁÇ∫„ÄåËê¨‰Ωõ‰πãÂúã„ÄçÔºå‰∏îÈ¶ñÈÉΩÊòØÊõºË∞∑Ôºü",
                    options: ["A. Á∑¨Áî∏", "B. Ê≥∞Âúã", "C. ÂØÆÂúã", "D. Êü¨ÂüîÂØ®"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "Êó•Êú¨ÁöÑË±°Âæµ„ÄåÂØåÂ£´Â±±„ÄçÂ±¨ÊñºÂì™Á®ÆÈ°ûÂûãÁöÑÁÅ´Â±±Ôºü",
                    options: ["A. ‰ºëÁú†ÁÅ´Â±±", "B. Ê≠ªÁÅ´Â±±", "C. Ê¥ªÁÅ´Â±±", "D. Ê≥•ÁÅ´Â±±"],
                    correctIndex: 2,
                    score: 1
                },
                {
                    text: "Êù±Âçó‰∫ûÂúãÂÆ∂‰∏≠ÔºåÂîØ‰∏Ä‰∏ÄÂÄãÂÖßÈô∏ÂúãÂÆ∂ÔºàÊ≤íÊúâÊµ∑Â≤∏Á∑öÔºâÁöÑÊòØÔºü",
                    options: ["A. Ë∂äÂçó", "B. ÂØÆÂúã", "C. Ê≥∞Âúã", "D. È¶¨‰æÜË•ø‰∫û"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "‰∫ûÊ¥≤ÊúÄÈï∑ÁöÑÊ≤≥ÊµÅÊòØÔºü",
                    options: ["A. ÊÅÜÊ≤≥", "B. ÊπÑÂÖ¨Ê≤≥", "C. Èï∑Ê±ü", "D. ÈªÉÊ≤≥"],
                    correctIndex: 2,
                    score: 1
                },
                {
                    text: "ËëóÂêçÊôØÈªû„ÄåÂê≥Âì•Á™ü„Äç‰ΩçÊñºÂì™ÂÄãÂúãÂÆ∂Ôºü",
                    options: ["A. Ê≥∞Âúã", "B. Êü¨ÂüîÂØ®", "C. Ë∂äÂçó", "D. Âç∞Â∞º"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "ÁõÆÂâç‰∏ñÁïå‰∏ä‰∫∫Âè£ÊúÄÂ§öÁöÑÂúãÂÆ∂ÊòØÔºü",
                    options: ["A. ÁæéÂúã", "B. Âç∞Â∞º", "C. ‰∏≠Âúã", "D. Âç∞Â∫¶"],
                    correctIndex: 3,
                    score: 1
                },
                {
                    text: "Ë™∞ÊúÄÊó©ÁôºÊòéÁ¥ôÂºµÔºü",
                    options: ["A. ÂüÉÂèä‰∫∫", "B. ‰∏≠Âúã‰∫∫", "C. Â∏åËáò‰∫∫", "D. ÂøçËÄÖÔºàÂØ´ÂØÜ‰ø°Áî®ÁöÑÔºâ"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "Êó•Êú¨Ê≠¶Â£´ÁÇ∫‰ªÄÈ∫ºÊúÉÊúâ„ÄåÂàáËÖπ„ÄçÁöÑÂÇ≥Áµ±Ôºü",
                    options: ["A. Â§™ÁÜ±‰∫ÜÊÉ≥ÈÄèÊ∞£", "B. ‰ª•Ê≠ªÊòéÂøóÂíåË≤†Ë≤¨", "C. ÊÉ≥Â≠∏È≠îË°ìË°®Êºî", "D. Âõ†ÁÇ∫ÁõîÁî≤Â§™Èõ£ËÑ´"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "Ê≥∞Âß¨Áë™ÂìàÈôµÁöÑÂª∫ÈÄ†ÂéüÂõ†ÊòØÔºü",
                    options: ["A. ÁöáÂ∏ùËìã‰æÜÊî∂ÊàøÁßü", "B. ÁöáÂ∏ùÁ¥ÄÂøµ‰∫°Â¶ª", "C. ÁöáÂ∏ùËìãÁµ¶Ëá™Â∑±Â∫¶ÂÅá", "D. ÁöáÂ∏ùËìãÁµ¶ÂØµÁâ©"],
                    correctIndex: 1,
                    score: 1
                }
            ]
        },
        {
            category: "Ê≠êÊ¥≤ (Europe)",
            questions: [
                {
                    text: "Ê≠êÊ¥≤Èù¢Á©çÊúÄÂ∞èÁöÑÂúãÂÆ∂ÔºåÂêåÊôÇ‰πüÊòØ‰∏ñÁïå‰∏äÈù¢Á©çÊúÄÂ∞èÁöÑ‰∏ªÊ¨äÂúãÂÆ∂ÊòØÔºü",
                    options: ["A. Êë©Á¥çÂì•", "B. ËÅñÈ¶¨Âà©Ë´æ", "C. Ê¢µËíÇÂ≤°", "D. ÂàóÊîØÊï¶ÊñØÁôª"],
                    correctIndex: 2,
                    score: 1
                },
                {
                    text: "‰∏ãÂàóÂì™‰∏ÄÊ¢ùÊ≤≥ÊµÅË¢´Á®±ÁÇ∫„ÄåÊ≠êÊ¥≤ÁöÑÊØçË¶™Ê≤≥„ÄçÔºå‰∏îÊµÅÁ∂ìÂúãÂÆ∂ÊúÄÂ§öÔºü",
                    options: ["A. ËêäËåµÊ≤≥", "B. Â°ûÁ¥çÊ≤≥", "C. Â§öÁëôÊ≤≥", "D. ‰ºèÁàæÂä†Ê≤≥"],
                    correctIndex: 2,
                    score: 1
                },
                {
                    text: "ÁëûÂ£´ÁöÑÈ¶ñÈÉΩÊòØ‰∏ãÂàóÂì™ÂÄãÂüéÂ∏ÇÔºü",
                    options: ["A. ËòáÈªé‰∏ñ", "B. Êó•ÂÖßÁì¶", "C. ‰ºØÊÅ©", "D. Ê¥õÊ°ë"],
                    correctIndex: 2,
                    score: 1
                },
                {
                    text: "‰ΩçÊñºÊ≥ïÂúãÂ∑¥ÈªéÔºåÁÇ∫‰∫ÜÁ¥ÄÂøµÊãøÁ†¥Â¥ôÊà∞Áà≠ÂãùÂà©ËÄåÂª∫ÁöÑËëóÂêçÂª∫ÁØâÊòØÔºü",
                    options: ["A. ËâæËè≤ÁàæÈêµÂ°î", "B. Âá±ÊóãÈñÄ", "C. ÁæÖÊµÆÂÆÆ", "D. Âá°ÁàæË≥ΩÂÆÆ"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "Ëã±ÂúãÁõÆÂâç‰ΩøÁî®ÁöÑË≤®Âπ£ÊòØÔºü",
                    options: ["A. Ê≠êÂÖÉ", "B. Ëã±Èéä", "C. Ê≥ïÈÉé", "D. ÂÖãÊúó"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "‰∏ãÂàóÂì™ÂÄãÂúãÂÆ∂Ë¢´Á®±ÁÇ∫„ÄåÂçÉÊπñ‰πãÂúã„ÄçÔºü",
                    options: ["A. Êå™Â®Å", "B. ÁëûÂÖ∏", "C. Ëä¨Ëò≠", "D. ‰∏πÈ∫•"],
                    correctIndex: 2,
                    score: 1
                },
                {
                    text: "Ê≠∑Âè≤‰∏äËëóÂêçÁöÑ„ÄåÊñáËóùÂæ©Ëàà„ÄçÈÅãÂãïÁôºÊ∫êÊñºÂì™ÂÄãÂúãÂÆ∂Ôºü",
                    options: ["A. Ê≥ïÂúã", "B. Â∏åËáò", "C. Áæ©Â§ßÂà©", "D. Âæ∑Âúã"],
                    correctIndex: 2,
                    score: 1
                },
                {
                    text: "Â∏åËáòÁ•ûË©±ÁöÑÊïÖ‰∫ãÂ∏∏Â∏∏ÂæàÊà≤ÂäáÂåñÔºåÂéüÂõ†ÊòØÔºü",
                    options: ["A. ÁúæÁ•ûÂ§™ÈñíÂñúÊ≠°È¨ß‰∫ã", "B. Á•û‰ªôÂÄëÊòØÂäáÂ†¥Âá∫Ë∫´", "C. Êó©ÊúüÈõªË¶ñÂè∞Á´∂Áà≠ÊøÄÁÉà", "D. ËÖ¶Ê¥ûÂ§™Â§ß"],
                    correctIndex: 0,
                    score: 1
                },
                {
                    text: "ÁæÖÈ¶¨Â∏ùÂúãÁÇ∫‰ªÄÈ∫ºËªç‰∫ãÂº∑Â§ßÔºü",
                    options: ["A. ÁõæÁâåÂæàÊôÇÂ∞ö", "B. ÈÅìË∑ØÂ∑•Á®ãÂ§™Âº∑", "C. ÁæÖÈ¶¨‰∫∫ÊÑõË∑ëÊ≠•", "D. ÁæÖÈ¶¨‰∫∫Áù°Áú†Â•Ω"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "Ê≥ïÂúãÂ∑¥Â£´Â∫ïÊó•ÊòØÁ¥ÄÂøµ‰ªÄÈ∫ºÔºü",
                    options: ["A. Á¨¨‰∏ÄÂÆ∂È∫µÂåÖÂ∫ó", "B. ‰∫∫Ê∞ëÊîªÂÖ•Áõ£ÁçÑÂºïÁôºÈù©ÂëΩ", "C. Á¨¨‰∏ÄÂÄãÊ≥ïÂºèÊøæÂ£ìÂ£∫", "D. Ê≥ïÂúãÁ¨¨‰∏ÄÈñìÂíñÂï°È§®"],
                    correctIndex: 1,
                    score: 1
                }
            ]
        },
        {
            category: "ÈùûÊ¥≤ (Africa)",
            questions: [
                {
                    text: "‰∏ñÁïåÊúÄÈï∑ÁöÑÊ≤≥ÊµÅ„ÄåÂ∞ºÁæÖÊ≤≥„Äç‰∏ªË¶ÅÊµÅÁ∂ìÂì™ÂÄãÂ§ßÈô∏Ôºü",
                    options: ["A. ‰∫ûÊ¥≤", "B. ÂçóÁæéÊ¥≤", "C. ÈùûÊ¥≤", "D. ÂåóÁæéÊ¥≤"],
                    correctIndex: 2,
                    score: 1
                },
                {
                    text: "ÈùûÊ¥≤ÊúÄÈ´òÁöÑÂ±±Â≥∞ÊòØÔºü",
                    options: ["A. ËÇØ‰∫ûÂ±±", "B. ÂêâÂäõÈ¶¨Êú≠ÁæÖÂ±±", "C. ÈòøÁâπÊãâÊñØÂ±±", "D. Âæ∑ÊãâËÇØÊñØÂ±±"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "ËëóÂêçÁöÑ„ÄåÈáëÂ≠óÂ°î„ÄçÂíå„Äå‰∫∫Èù¢ÁçÖË∫´ÂÉè„Äç‰ΩçÊñºÂì™ÂÄãÂúãÂÆ∂Ôºü",
                    options: ["A. Ëòá‰∏π", "B. ÂüÉÂèä", "C. Âà©ÊØî‰∫û", "D. ÈòøÁàæÂèäÂà©‰∫û"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "ÊìÅÊúâ„ÄåÂΩ©ËôπÂúãÂ∫¶„ÄçÁæéÁ®±Ôºå‰∏îÊõæÂØ¶ÊñΩÁ®ÆÊóèÈöîÈõ¢ÊîøÁ≠ñÁöÑÂúãÂÆ∂ÊòØÔºü",
                    options: ["A. Â•àÂèäÂà©‰∫û", "B. ËÇØ‰∫û", "C. ÂçóÈùû", "D. ÂüÉÂèä"],
                    correctIndex: 2,
                    score: 1
                },
                {
                    text: "‰∏ñÁïåÊúÄÂ§ßÁöÑÁÜ±Â∏∂Ê≤ôÊº†ÊòØÔºü",
                    options: ["A. ÊààÂ£ÅÊ≤ôÊº†", "B. ÂñÄÊãâÂìàÈáåÊ≤ôÊº†", "C. ÊííÂìàÊãâÊ≤ôÊº†", "D. Â°îÂÖãÊãâÁë™Âπ≤Ê≤ôÊº†"],
                    correctIndex: 2,
                    score: 1
                },
                {
                    text: "ÂãïÁï´„ÄäÈ¶¨ÈÅîÂä†ÊñØÂä†„Äã‰∏≠ÁöÑÈ¶¨ÈÅîÂä†ÊñØÂä†Â≥∂‰ΩçÊñºÈùûÊ¥≤ÁöÑÂì™ÂÄãÊñπÂêëÔºü",
                    options: ["A. Êù±ÂåóÈÉ®", "B. Êù±ÂçóÈÉ®", "C. Ë•øÂåóÈÉ®", "D. Ë•øÂçóÈÉ®"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "ÈùûÊ¥≤ÁõÆÂâçÈù¢Á©çÊúÄÂ§ßÁöÑÂúãÂÆ∂ÊòØÔºü",
                    options: ["A. Ëòá‰∏π", "B. ÈòøÁàæÂèäÂà©‰∫û", "C. ÂâõÊûúÊ∞ë‰∏ªÂÖ±ÂíåÂúã", "D. Â•àÂèäÂà©‰∫û"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "Âè§ÂüÉÂèä‰∫∫ÁÇ∫‰ªÄÈ∫ºÂ¥áÊãúË≤ìÔºü",
                    options: ["A. Âõ†ÁÇ∫Ë≤ìÊúÉÂπ´ÂøôÂØ´Ë±°ÂΩ¢ÊñáÂ≠ó", "B. Âõ†ÁÇ∫Ë≤ìÈ´òË≤¥ÂèàÁ•ûÁßò", "C. Âõ†ÁÇ∫Ë≤ìÂ§™ÂèØÊÑõ", "D. Âõ†ÁÇ∫Ê≥ïËÄÅÈ§ä‰∫ÜÂ§™Â§ö"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "‰∫∫È°ûÊúÄÊó©ÁöÑÁ•ñÂÖàÁÇ∫‰ªÄÈ∫ºÂá∫ÁèæÂú®ÈùûÊ¥≤Ôºü",
                    options: ["A. Â§©Ê∞£ËàíÊúçË≥áÊ∫êÂ§ö", "B. GPS Ë®≠ÂÆöÂú®ÈùûÊ¥≤", "C. Âõ†ÁÇ∫ÊúÄÂÖàÊúâ Wi-Fi", "D. Âõ†ÁÇ∫ÊúÄÂÖàÊúâÂèØÂèØË±Ü"],
                    correctIndex: 0,
                    score: 1
                },
                {
                    text: "ÊõºËñ©Á©ÜËñ©ÁöáÂ∏ùÁÇ∫‰ªÄÈ∫ºË¢´Á®±ÁÇ∫„ÄåÈùûÊ¥≤È¶ñÂØå„ÄçÔºü",
                    options: ["A. ÊåñÂà∞Áü≥Ê≤π", "B. ÊóÖÈÄî‰∏≠ÊííÈå¢ÊííÂà∞ÈÄ†ÊàêÈÄöËÜ®", "C. ‰ªñÊòØÊäïË≥áÂ§©Êâç", "D. ‰∏≠‰∫ÜÂè§‰ª£Ê®ÇÈÄè"],
                    correctIndex: 1,
                    score: 1
                }
            ]
        },
        {
            category: "ÂåóÁæéÊ¥≤ (N. America)",
            questions: [
                {
                    text: "Âä†ÊãøÂ§ßÁöÑÈ¶ñÈÉΩÊòØÔºü",
                    options: ["A. Â§öÂÄ´Â§ö", "B. Ê∫´Âì•ËèØ", "C. Ê∏•Â§™ËèØ", "D. ËíôÁâπÂ©Å"],
                    correctIndex: 2,
                    score: 1
                },
                {
                    text: "‰ΩçÊñºÁæéÂúãÁ¥êÁ¥ÑÊ∏ØÔºåË±°ÂæµËá™Áî±ËàáÊ∞ë‰∏ªÁöÑËëóÂêçÈõïÂÉèÊòØÔºü",
                    options: ["A. Êïë‰∏ñÂü∫Áù£ÂÉè", "B. Ëá™Áî±Â•≥Á•ûÂÉè", "C. ÊûóËÇØÁ¥ÄÂøµÂ†Ç", "D. ËèØÁõõÈ†ìÁ¥ÄÂøµÁ¢ë"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "ÁæéÂúãÁöÑÂÆòÊñπË™ûË®ÄÊòØÔºü",
                    options: ["A. Ëã±Ë™û", "B. Ë•øÁè≠ÁâôË™û", "C. Ê≥ïË™û", "D. ËÅØÈÇ¶Â±§Á¥öÊ≤íÊúâÊ≥ïÂÆöÂÆòÊñπË™ûË®Ä"],
                    correctIndex: 3,
                    score: 1
                },
                {
                    text: "‰∏ñÁïåÁ¨¨‰∏ÄÂ§ßÂ≥∂„ÄåÊ†ºÈôµËò≠„ÄçÂú®Âú∞ÁêÜ‰∏äÂ±¨ÊñºÂì™ÂÄãÊ¥≤Ôºü",
                    options: ["A. Ê≠êÊ¥≤", "B. ÂåóÁæéÊ¥≤", "C. ‰∫ûÊ¥≤", "D. ÂçóÊ•µÊ¥≤"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "ÈÄ£Êé•Â§™Âπ≥Ê¥ãËàáÂ§ßË•øÊ¥ãÁöÑ„ÄåÂ∑¥ÊãøÈ¶¨ÈÅãÊ≤≥„Äç‰ΩçÊñºÂì™Ë£°Ôºü",
                    options: ["A. ÂçóÁæéÊ¥≤", "B. ÂåóÁæéÊ¥≤/‰∏≠ÁæéÊ¥≤", "C. Ê≠êÊ¥≤", "D. ÈùûÊ¥≤"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "ËëóÂêçÁöÑÈõªÂΩ±Áî¢Ê•≠‰∏≠ÂøÉ„ÄåÂ•ΩËêäÂ°¢ (Hollywood)„Äç‰ΩçÊñºÁæéÂúãÁöÑÂì™ÂÄãÂ∑ûÔºü",
                    options: ["A. Á¥êÁ¥ÑÂ∑û", "B. Âæ∑Â∑û", "C. Âä†Â∑û", "D. ‰ΩõÁæÖÈáåÈÅîÂ∑û"],
                    correctIndex: 2,
                    score: 1
                },
                {
                    text: "ËëóÂêçÁöÑ„ÄåÂ∞ºÂä†ÊãâÁÄëÂ∏É„Äç‰ΩçÊñºÂì™ÂÖ©ÂÄãÂúãÂÆ∂ÁöÑÈÇäÁïåÔºü",
                    options: ["A. ÁæéÂúãËàáÂ¢®Ë•øÂì•", "B. ÁæéÂúãËàáÂä†ÊãøÂ§ß", "C. Âä†ÊãøÂ§ßËàáÊ†ºÈôµËò≠", "D. Â∑¥Ë•øËàáÈòøÊ†πÂª∑"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "ÁæéÂúãÂêçÂ≠ó„ÄåAmerica„Äç‰æÜÊ∫êÊòØÔºü",
                    options: ["A. Âõ†ÁÇ∫Â§™Áæé‰∫Ü", "B. Êé¢Èö™ÂÆ∂ Amerigo ÁöÑÂêçÂ≠ó", "C. Âéü‰ΩèÊ∞ëÁöÑÁ®±Âëº", "D. ÂåóÁæéÊúÄÁæéÁöÑÂú∞Êñπ"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "Áë™ÈõÖÊñáÊòéÁöÑ„Äå‰∏ñÁïåÊú´Êó•„ÄçÂÇ≥Ë™™ÊÄéÈ∫º‰æÜÁöÑÔºü",
                    options: ["A. ‰ªñÂÄëÁúüÁöÑÁÆóÂà∞‰∏ñÁïåË¶ÅÁàÜÁÇ∏", "B. ÊúàÊõÜÂØ´Âà∞ÈÇ£Ë£°ËÄåÂ∑≤", "C. ‰ªñÂÄëÊá∂ÂæóÂØ´Êõ¥Â§ö", "D. Áï´ÂÆ∂Ë´ãÂÅá‰∫Ü"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "ÁæéÂúãÁç®Á´ãÊà∞Áà≠ÁöÑÂ∞éÁÅ´Á∑öÊòØÔºü",
                    options: ["A. Êä´Ëñ©Êº≤ÂÉπ", "B. ‰∏çÁàΩËã±ÂúãÂä†Á®Ö", "C. Ëå∂Â§™Èõ£Âñù", "D. ÊÆñÊ∞ëÂú∞ÂÅúÈõª"],
                    correctIndex: 1,
                    score: 1
                }
            ]
        },
        {
            category: "ÂçóÁæéÊ¥≤ (S. America)",
            questions: [
                {
                    text: "ÊìÅÊúâ‰∏ñÁïåÊúÄÂ§ßÁÜ±Â∏∂Èõ®ÊûóÔºå‰∏îÊòØÂçóÁæéÊ¥≤Èù¢Á©çÊúÄÂ§ßÁöÑÂúãÂÆ∂ÊòØÔºü",
                    options: ["A. ÈòøÊ†πÂª∑", "B. Êô∫Âà©", "C. Â∑¥Ë•ø", "D. ÁßòÈ≠Ø"],
                    correctIndex: 2,
                    score: 1
                },
                {
                    text: "Âè§‰ª£ÊñáÊòé„ÄåÂç∞Âä†Â∏ùÂúã„Äç‰∏ªË¶ÅÂàÜ‰ΩàÂú®Áèæ‰ªäÂì™ÂÄãÂ±±ËÑàÂçÄÂüüÔºü",
                    options: ["A. ËêΩÁ£ØÂ±±ËÑà", "B. ÈòøÂ∏ïÊãâÂ•ëÂ±±ËÑà", "C. ÂÆâÂú∞ÊñØÂ±±ËÑà", "D. ÈòøÁàæÂçëÊñØÂ±±ËÑà"],
                    correctIndex: 2,
                    score: 1
                },
                {
                    text: "ÂçóÁæéÊ¥≤ÊúÄÁãπÈï∑ÁöÑÂúãÂÆ∂ÔºåË¢´Á®±ÁÇ∫„ÄåÁµ≤Â∏∂Âúã„ÄçÁöÑÊòØÔºü",
                    options: ["A. Êô∫Âà©", "B. ÂéÑÁìúÂ§ö", "C. ÂßîÂÖßÁëûÊãâ", "D. ÁÉèÊãâÂú≠"],
                    correctIndex: 0,
                    score: 1
                },
                {
                    text: "‰ΩçÊñºÂ∑¥Ë•øÈáåÁ¥ÑÁÜ±ÂÖßÁõßÔºåÂºµÈñãÈõôËáÇÁöÑËëóÂêçÂú∞Ê®ôÊòØÔºü",
                    options: ["A. Ëá™Áî±Â•≥Á•ûÂÉè", "B. Êïë‰∏ñÂü∫Áù£ÂÉè", "C. Â§ßË°õÂÉè", "D. ÊÄùÊÉ≥ËÄÖ"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "‰∏ñÁïåÊúÄÈ´òÁöÑÁÄëÂ∏É„ÄåÂÆâËµ´ÁàæÁÄëÂ∏É (Angel Falls)„Äç‰ΩçÊñºÔºü",
                    options: ["A. Â∑¥Ë•ø", "B. ÈòøÊ†πÂª∑", "C. ÂßîÂÖßÁëûÊãâ", "D. Âì•ÂÄ´ÊØî‰∫û"],
                    correctIndex: 2,
                    score: 1
                },
                {
                    text: "Á•ûÁ•ïÁöÑÂè§Ëπü„ÄåÈ¶¨‰∏òÊØî‰∏ò„Äç‰ΩçÊñºÂì™ÂÄãÂúãÂÆ∂Ôºü",
                    options: ["A. ÁßòÈ≠Ø", "B. Êô∫Âà©", "C. ÁéªÂà©Á∂≠‰∫û", "D. Â¢®Ë•øÂì•"],
                    correctIndex: 0,
                    score: 1
                },
                {
                    text: "ÈòøÊ†πÂª∑ÁöÑÈ¶ñÈÉΩÊòØÔºü",
                    options: ["A. ËÅñÂú∞‰∫ûÂì•", "B. Âà©È¶¨", "C. Ê≥¢Âì•Â§ß", "D. Â∏ÉÂÆúË´æÊñØËâæÂà©ÊñØ"],
                    correctIndex: 3,
                    score: 1
                },
                {
                    text: "Âç∞Âä†Â∏ùÂúãÊ≤íÊúâÈêµÂô®ÂíåÈ¶¨ÔºåÂçªÂº∑ÁõõÁöÑÂéüÂõ†Ôºü",
                    options: ["A. È≠îÊ≥ï", "B. Â∑•Á®ãËàáÁÆ°ÁêÜËÉΩÂäõË∂ÖÂº∑", "C. ÊØèÂ§©Ë∑ëÂ±±Á∑¥Ë∫´È´î", "D. Â§™ÈôΩÁ•ûÂä†ÊåÅ"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "‰∫ûÈ¶¨ÈÅúÈõ®ÊûóÁÇ∫‰ªÄÈ∫ºË¢´Âè´ÂÅöÂú∞ÁêÉ‰πãËÇ∫Ôºü",
                    options: ["A. Âõ†ÁÇ∫ÂÆÉÊúÉÂëºÂê∏", "B. ÁîüÁî¢Â§ßÈáèÊ∞ßÊ∞£", "C. Âõ†ÁÇ∫ÂΩ¢ÁãÄÂÉèËÇ∫", "D. Ê£ÆÊûóË£°ÊúâË®∫ÊâÄ"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "Â∑¥Ë•øÁãÇÊ≠°ÁØÄÈÇ£È∫ºÁÜ±È¨ßÁöÑÂéüÂõ†Ôºü",
                    options: ["A. ‰∏çÁî®‰∏äÁè≠", "B. Êãâ‰∏ÅÊñáÂåñ + ÈùûÊ¥≤ÊñáÂåñËûçÂêà", "C. ËàûÈûãÂÖçË≤ª", "D. Â§©Ê∞£Â§™ÁÜ±ÂøÖÈ†àË∑≥ËàûÊï£ÁÜ±"],
                    correctIndex: 1,
                    score: 1
                }
            ]
        },
        {
            category: "Â§ßÊ¥ãÊ¥≤ (Oceania)",
            questions: [
                {
                    text: "Êæ≥Ê¥≤ÁöÑÈ¶ñÈÉΩÊòØÔºü",
                    options: ["A. Èõ™Ê¢®", "B. Â¢®ÁàæÊú¨", "C. ÂùéÂüπÊãâ", "D. Â∏ÉÈáåÊñØÊú¨"],
                    correctIndex: 2,
                    score: 1
                },
                {
                    text: "Á¥êË•øËò≠ËëóÂêçÁöÑÂéü‰ΩèÊ∞ëÊñáÂåñÊòØÔºü",
                    options: ["A. Èòø‰ºäÂä™‰∫∫", "B. ÊØõÂà©‰∫∫", "C. Âõ†Á¥êÁâπ‰∫∫", "D. Á•ñÈ≠Ø‰∫∫"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "‰∏ñÁïå‰∏äÊúÄÂ§ßÁöÑÁèäÁëöÁ§ÅÁæ§„ÄåÂ§ßÂ†°Á§Å„Äç‰ΩçÊñºÂì™ÂÄãÂúãÂÆ∂ÁöÑÊµ∑Â≤∏Ôºü",
                    options: ["A. Á¥êË•øËò≠", "B. ÊñêÊøü", "C. Êæ≥Ê¥≤", "D. Â∑¥Â∏É‰∫ûÁ¥êÂπæÂÖß‰∫û"],
                    correctIndex: 2,
                    score: 1
                },
                {
                    text: "Êúâ„ÄåÂ•áÁï∞È≥• (Kiwi)„Äç‰ΩúÁÇ∫ÂúãÈ≥•ÁöÑÂúãÂÆ∂ÊòØÔºü",
                    options: ["A. Êæ≥Ê¥≤", "B. Á¥êË•øËò≠", "C. Ëñ©Êë©‰∫û", "D. Êù±Âä†"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "Â§ßÊ¥ãÊ¥≤Èù¢Á©çÊúÄÂ§ßÁöÑÂúãÂÆ∂ÊòØÔºü",
                    options: ["A. Á¥êË•øËò≠", "B. Â∑¥Â∏É‰∫ûÁ¥êÂπæÂÖß‰∫û", "C. Êæ≥Ê¥≤", "D. Á¥¢ÁæÖÈñÄÁæ§Â≥∂"],
                    correctIndex: 2,
                    score: 1
                },
                {
                    text: "‰∏ãÂàóÂì™Á®ÆÂãïÁâ©ÊòØÊæ≥Ê¥≤ÁâπÊúâÔºå‰∏îÊòØÊúâË¢ãÈ°ûÂãïÁâ©Ôºü",
                    options: ["A. ÁÜäË≤ì", "B. ÁÑ°Â∞æÁÜä", "C. Ê®πÊá∂", "D. Êµ£ÁÜä"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "ËëóÂêçÊóÖÈÅäÂãùÂú∞„ÄåÊ≥¢ÊãâÊ≥¢ÊãâÂ≥∂ (Bora Bora)„Äç‰ΩçÊñºÂì™Ë£°Ôºü",
                    options: ["A. Â§èÂ®ÅÂ§∑", "B. Ê≥ïÂ±¨ÁéªÈáåÂ∞ºË•ø‰∫û", "C. ÊñêÊøü", "D. ÈóúÂ≥∂"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "Ë¢ãÈº†ÁÇ∫‰ªÄÈ∫ºÁî®Ë∑≥ÁöÑÔºü",
                    options: ["A. Ëµ∞Ë∑ØÂ§™ÊÖ¢", "B. Ë∑≥ÊØîËºÉÁúÅÂäõ", "C. ÊÉ≥ÁúãËµ∑‰æÜÊõ¥ÂèØÊÑõ", "D. ÁÇ∫‰∫ÜÊØîË≥ΩË∑≥È´ò"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "ÊØõÂà©‰∫∫ËáâÈÉ®Âà∫ÈùíÔºàMokoÔºâ‰ª£Ë°®‰ªÄÈ∫ºÔºü",
                    options: ["A. ÁæéÂÆπ", "B. ÂÄã‰∫∫Ë∫´ÂàÜËàáÂÆ∂ÊóèÂú∞‰Ωç", "C. Èò≤Ëöä", "D. Êà≤ÂäáËßíËâ≤"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "Êæ≥Ê¥≤Êó©ÊúüË¢´Ëã±ÂúãÁï∂‰ªÄÈ∫ºÂú∞Êñπ‰ΩøÁî®Ôºü",
                    options: ["A. Â∫¶ÂÅáÂ≥∂", "B. Êá≤ÁΩ∞Â≥∂ÔºàÊµÅÊîæÁäØ‰∫∫Ôºâ", "C. ÁöáÂÆ§ÈÄÄ‰ºëÊùë", "D. ÁæäÂí©Âí©Â§©Â†Ç"],
                    correctIndex: 1,
                    score: 1
                }
            ]
        },
        {
            category: "ÂçóÊ•µÊ¥≤ (Antarctica)",
            questions: [
                {
                    text: "ÂçóÊ•µÊ¥≤ÊòØÂú∞ÁêÉ‰∏äÂîØ‰∏ÄÊ≤íÊúâ‰ªÄÈ∫ºÂ∏∏‰ΩèÂ±ÖÊ∞ëÁöÑÂ§ßÈô∏Ôºü",
                    options: ["A. ‰ºÅÈµù", "B. ÁßëÂ≠∏ÂÆ∂", "C. Âéü‰ΩèÊ∞ë", "D. ÈÅäÂÆ¢"],
                    correctIndex: 2,
                    score: 1
                },
                {
                    text: "Âú®ÂçóÊ•µÊ¥≤ÁµïÂ∞çÁúã‰∏çÂà∞‰∏ãÂàóÂì™Á®ÆÂãïÁâ©ÔºàÈáéÁîüÁãÄÊÖã‰∏ãÔºâÔºü",
                    options: ["A. ‰ºÅÈµù", "B. Êµ∑Ë±π", "C. ÂåóÊ•µÁÜä", "D. Á£∑Ëù¶"],
                    correctIndex: 2,
                    score: 1
                },
                {
                    text: "ÂçóÊ•µÊ¥≤ÊìÅÊúâ‰∏ñÁïå‰∏äÈù¢Á©çÊúÄÂ§ßÁöÑ‰ªÄÈ∫ºÂú∞Ë≤åÔºü",
                    options: ["A. ÁÜ±Â∏∂Èõ®Êûó", "B. ËçâÂéü", "C. ËçíÊº†ÔºàÂÜ∑Ê≤ôÊº†Ôºâ", "D. Ê≤ºÊæ§"],
                    correctIndex: 2,
                    score: 1
                },
                {
                    text: "Âì™‰∏Ä‰ΩçÊé¢Èö™ÂÆ∂Â∏∂È†òÁöÑÂúòÈöäÈ¶ñÂÖàÊäµÈÅî‰∫ÜÂçóÊ•µÈªûÔºü",
                    options: ["A. ÁæÖ‰ºØÁâπ¬∑Âè≤ËÄÉÁâπ", "B. ÁæÖÁàæÂæ∑¬∑ÈòøËíôÊ£Æ", "C. ÊÅ©ÊñØÁâπ¬∑Ê≤ôÂÖãÁàæÈ†ì", "D. Ë©πÂßÜÊñØ¬∑Â∫´ÂÖã"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "Ê†πÊìö„ÄäÂçóÊ•µÊ¢ùÁ¥Ñ„ÄãÔºåÂçóÊ•µÊ¥≤ÁöÑ‰∏ªË¶ÅÁî®ÈÄîÊòØÔºü",
                    options: ["A. Ëªç‰∫ãÂü∫Âú∞Ê∏¨Ë©¶", "B. Ê†∏Âª¢ÊñôËôïÁΩÆ", "C. ÂíåÂπ≥ÁõÆÁöÑËàáÁßëÂ≠∏Á†îÁ©∂", "D. ÂïÜÊ•≠Á§¶Áî¢ÈñãÊé°"],
                    correctIndex: 2,
                    score: 1
                },
                {
                    text: "ÂçóÊ•µÊ¥≤Ë¢´Â§ßÈáèÂÜ∞Èõ™Ë¶ÜËìãÔºåÂÖ∂ÂÜ∞ËìãÂÑ≤Â≠ò‰∫ÜÂú∞ÁêÉ‰∏äÁ¥ÑÂ§öÂ∞ëÊØî‰æãÁöÑÊ∑°Ê∞¥Ôºü",
                    options: ["A. 10%", "B. 30%", "C. 50%", "D. 70%"],
                    correctIndex: 3,
                    score: 1
                },
                {
                    text: "ÂçóÊ•µÊ¥≤ÁöÑÊúÄÈ´òÂ≥∞ÊòØÔºü",
                    options: ["A. ÂêâÂäõÈ¶¨Êú≠ÁæÖÂ±±", "B. ÊñáÊ£ÆÂ±±", "C. È∫•ÈáëÂà©Â±±", "D. ËâæÁàæÂ∏ÉÈ≠ØÊñØÂ≥∞"],
                    correctIndex: 1,
                    score: 1
                },
                {
                    text: "ÁÇ∫‰ªÄÈ∫ºÂçóÊ•µÊ¥≤Ê≤íÊúâÂéü‰ΩèÊ∞ëÔºü",
                    options: ["A. Âõ†ÁÇ∫Â§™ÂÜ∑", "B. Âõ†ÁÇ∫Ê≤íÊúâ Wi-Fi", "C. Âõ†ÁÇ∫Ê≤íÊúâÂíñÂï°Â∫ó", "D. Âõ†ÁÇ∫Ê≤íÊúâÂ§ñÈÄÅ"],
                    correctIndex: 0,
                    score: 1
                },
                {
                    text: "‰ºÅÈµùÁÇ∫‰ªÄÈ∫º‰∏çÊê¨ÂéªÁÜ±Â∏∂ÂúãÂÆ∂Ôºü",
                    options: ["A. Áâ†ÂÄëÊÄïÊõ¨Èªë", "B. Áâ†ÂÄëÈ´îÊ∫´Â§™È´ò", "C. Áâ†ÂÄëÂ§™ÊÑõÂÜ∑", "D. Áâ†ÂÄëÊ≤íË≠∑ÁÖß"],
                    correctIndex: 2,
                    score: 1
                },
                {
                    text: "ÂçóÊ•µÊ¥≤ÁÇ∫‰ªÄÈ∫ºÊ≤íÊúâÂúãÂÆ∂Ôºü",
                    options: ["A. Âõ†ÁÇ∫Â§ßÂÆ∂Êá∂ÂæóÁà≠", "B. Âõ†ÁÇ∫Â§™Êªë‰∏çÊÉ≥Ëµ∞", "C. Âõ†ÁÇ∫ÊúâÂúãÈöõÊ¢ùÁ¥Ñ‰øùË≠∑", "D. Âõ†ÁÇ∫‰ºÅÈµù‰∏çÊÉ≥Ë¶ÅÊîøÂ∫ú"],
                    correctIndex: 2,
                    score: 1
                }
            ]
        }
    ];

    let currentCategoryIndex = 0;
    let currentQuestionIndex = 0;
    
    // ÂàùÂßãÂåñ 6 ‰ΩçÂèÉË≥ΩËÄÖÁöÑÂàÜÊï∏
    let scores = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0 };
    // Â∞çÊáâÁöÑÂêçÂ≠óÂàóË°®ÔºåÁî®ÊñºÊéíË°åÊ¶ú
    const playerNames = {
        1: "Ë¨ùÊ≤õËÆå", 2: "Ëî°ÁâßË¨ô", 3: "Âê≥ËªçÊÖß", 
        4: "Âê≥Â≤±ÂÄ´", 5: "Èô≥ÊñáË±´", 6: "Èô≥ÊÄ°Èúñ"
    };

    let visitedQuestions = new Set();
    let stopConfettiFunc = null;

    function init() {
        attachSoundEvents();

        const categoryList = document.getElementById('category-list');
        gameData.forEach((cat, index) => {
            const btn = document.createElement('button');
            btn.className = 'btn btn-category';
            btn.innerText = cat.category;
            btn.onclick = () => {
                SoundSystem.playClick();
                playWipeTransition(() => showSelectionPage(index));
            };
            categoryList.appendChild(btn);
        });
        
        document.addEventListener("fullscreenchange", () => {
            const fsBtn = document.getElementById('fs-btn');
            if (document.fullscreenElement) {
                fsBtn.innerText = '‚ùê'; 
            } else {
                fsBtn.innerText = '‚ñ°'; 
            }
        });
    }

    function attachSoundEvents() {
        const buttons = document.querySelectorAll('button');
        buttons.forEach(btn => {
            btn.onmouseenter = () => SoundSystem.playHover();
        });
    }

    function playWipeTransition(callback) {
        SoundSystem.playDataNoise(); 
        const overlay = document.getElementById('wipe-overlay');
        const loadingText = document.getElementById('loading-text');
        
        let dots = 0;
        loadingText.innerText = "Loading";
        loadingText.style.display = 'block';
        
        const dotInterval = setInterval(() => {
            dots = (dots + 1) % 4;
            let str = "Loading";
            for(let i=0; i<dots; i++) str += ".";
            loadingText.innerText = str;
        }, 150); 

        overlay.classList.add('wipe-active');
        
        setTimeout(() => {
            callback();
            setTimeout(() => { 
                overlay.classList.remove('wipe-active');
                clearInterval(dotInterval);
                loadingText.style.display = 'none';
            }, 800); 
        }, 800); 
    }

    function startMatrixEffect(callback) {
        SoundSystem.playDataNoise(); 
        const canvas = document.getElementById('matrix-canvas');
        const ctx = canvas.getContext('2d');
        canvas.style.display = 'block';
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
        const fontSize = 16;
        const columns = canvas.width / fontSize;
        const drops = [];
        for(let i=0; i<columns; i++) drops[i] = Math.random() * -50; 

        let animationId;

        function draw() {
            ctx.fillStyle = 'rgba(0, 0, 0, 0.05)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#0F0';
            ctx.font = fontSize + 'px monospace';

            for (let i = 0; i < drops.length; i++) {
                const text = letters.charAt(Math.floor(Math.random() * letters.length));
                ctx.fillText(text, i * fontSize, drops[i] * fontSize);
                drops[i]++;
            }
            animationId = requestAnimationFrame(draw);
        }

        draw();

        setTimeout(() => {
            cancelAnimationFrame(animationId);
            canvas.style.display = 'none';
            callback();
        }, 800);
    }

    function startConfetti() {
        const canvas = document.getElementById('matrix-canvas'); 
        const ctx = canvas.getContext('2d');
        canvas.style.display = 'block';
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const confettiCount = 150;
        const confetti = [];
        const colors = ['#ff0000', '#00ff00', '#0000ff', '#ffff00', '#00ffff', '#ff00ff'];

        for (let i = 0; i < confettiCount; i++) {
            confetti.push({
                x: Math.random() * canvas.width,
                y: Math.random() * canvas.height - canvas.height,
                w: Math.random() * 10 + 5,
                h: Math.random() * 10 + 5,
                color: colors[Math.floor(Math.random() * colors.length)],
                speed: Math.random() * 3 + 2,
                drift: Math.random() * 2 - 1
            });
        }

        let animationId;

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            confetti.forEach((c, index) => {
                ctx.fillStyle = c.color;
                ctx.fillRect(c.x, c.y, c.w, c.h); 

                c.y += c.speed;
                c.x += c.drift;

                if (c.y > canvas.height) {
                    confetti[index].y = -10;
                    confetti[index].x = Math.random() * canvas.width;
                }
            });

            animationId = requestAnimationFrame(draw);
        }

        draw();
        
        return () => {
            cancelAnimationFrame(animationId);
            canvas.style.display = 'none';
            ctx.clearRect(0, 0, canvas.width, canvas.height);
        };
    }

    function showSelectionPage(catIndex) {
        currentCategoryIndex = catIndex;
        document.getElementById('win-title').innerText = "World_Map.exe - " + gameData[catIndex].category;
        
        const qList = document.getElementById('question-list');
        qList.innerHTML = ''; 
        const questions = gameData[catIndex].questions;
        if (questions.length === 0) {
            qList.innerHTML = '<p style="font-size:2em;">(Êö´ÁÑ°È°åÁõÆ)</p>';
        } else {
            questions.forEach((q, index) => {
                const btn = document.createElement('button');
                btn.className = 'btn btn-question';
                btn.innerText = index + 1;
                
                if (visitedQuestions.has(`${catIndex}-${index}`)) {
                    btn.classList.add('visited');
                }

                btn.onmouseenter = () => SoundSystem.playHover();
                btn.onclick = () => {
                    SoundSystem.playClick();
                    showQuestionPage(index);
                };
                
                qList.appendChild(btn);
            });
        }
        switchPage('page-selection');
    }

    function showQuestionPage(qIndex) {
        currentQuestionIndex = qIndex;
        const qData = gameData[currentCategoryIndex].questions[qIndex];
        document.getElementById('win-title').innerText = "Question_Viewer.exe";
        document.getElementById('q-score').innerText = qData.score;
        
        const contentArea = document.getElementById('question-content-area');
        contentArea.innerHTML = ''; 

        const textH2 = document.createElement('h2');
        textH2.id = 'q-text';
        textH2.innerHTML = qData.text;
        contentArea.appendChild(textH2);
        
        const optionsDiv = document.getElementById('q-options');
        const shortAnswerDiv = document.getElementById('short-answer-text');
        const revealBtn = document.getElementById('reveal-btn');
        
        optionsDiv.innerHTML = '';
        shortAnswerDiv.style.display = 'none'; 
        shortAnswerDiv.innerText = '';

        revealBtn.innerText = "ÁúãÁ≠îÊ°à"; 

        if (qData.options && qData.options.length > 0) {
            qData.options.forEach((opt, index) => {
                const div = document.createElement('div');
                div.className = 'option';
                div.id = 'opt-' + index;
                div.innerText = opt;
                div.onmouseenter = () => SoundSystem.playHover();
                optionsDiv.appendChild(div);
            });
        } 

        document.getElementById('reveal-btn').style.display = 'inline-block';
        switchPage('page-question');
    }

    function revealAnswer() {
        SoundSystem.playCoin(); 
        const qData = gameData[currentCategoryIndex].questions[currentQuestionIndex];
        
        if (qData.options && qData.options.length > 0) {
            const correctIdx = qData.correctIndex;
            const correctDiv = document.getElementById('opt-' + correctIdx);
            if(correctDiv) { correctDiv.classList.add('correct-answer'); }
        } else {
            const shortAnswerDiv = document.getElementById('short-answer-text');
            shortAnswerDiv.innerText = qData.answerText;
            shortAnswerDiv.style.display = 'block';
        }

        document.getElementById('reveal-btn').style.display = 'none';
        visitedQuestions.add(`${currentCategoryIndex}-${currentQuestionIndex}`);
    }

    function updateScore(playerId, change) {
        SoundSystem.playClick();
        scores[playerId] += change;
        document.getElementById('score-player-' + playerId).innerText = scores[playerId];
    }

    function switchPage(pageId) {
        document.querySelectorAll('.page').forEach(el => el.classList.remove('active'));
        document.getElementById(pageId).classList.add('active');
    }

    function startGame() {
        SoundSystem.init(); 
        SoundSystem.playClick();
        switchPage('page-home');
    }

    function goHome() {
        document.getElementById('win-title').innerText = "World_Map.exe";
        switchPage('page-home');
    }

    function goHomeWithMatrix() {
        startMatrixEffect(() => {
            goHome();
        });
    }

    function goBackToSelection() {
        showSelectionPage(currentCategoryIndex);
    }

    function showLeaderboard() {
        let sortedScores = Object.keys(scores).map(key => {
            return { id: key, score: scores[key] };
        }).sort((a, b) => b.score - a.score);

        const maxScore = sortedScores[0].score;
        const winners = sortedScores.filter(s => s.score === maxScore);
        
        let winnerText = "";
        if (winners.length === 1) {
            winnerText = `${playerNames[winners[0].id]} (${winners[0].score}ÂàÜ)`;
        } else {
            const winnerNames = winners.map(w => playerNames[w.id]).join(" & ");
            winnerText = `${winnerNames} ‰∏¶ÂàóÂÜ†Ëªç (${maxScore}ÂàÜ)`;
        }
        document.getElementById('winner-display').innerText = winnerText;

        const listDiv = document.getElementById('rank-list');
        listDiv.innerHTML = '';
        
        let displayRank = 1;
        for (let i = 0; i < sortedScores.length; i++) {
            if (i > 0 && sortedScores[i].score < sortedScores[i-1].score) {
                displayRank++; 
            }
            
            listDiv.innerHTML += `
                <div class="rank-item">
                    <span>Rank ${displayRank}: ${playerNames[sortedScores[i].id]}</span>
                    <span>${sortedScores[i].score} pts</span>
                </div>`;
        }

        switchPage('page-leaderboard');
        stopConfettiFunc = startConfetti();
    }

    function restartGame() {
        if (stopConfettiFunc) stopConfettiFunc();
        // Ê∏ÖÈô§ 6 ‰ΩçÁé©ÂÆ∂ÁöÑÂàÜÊï∏
        scores = { 1: 0, 2: 0, 3: 0, 4: 0, 5: 0, 6: 0 };
        for(let i=1; i<=6; i++){
            document.getElementById('score-player-' + i).innerText = 0;
        }
        visitedQuestions.clear();
        
        switchPage('page-start');
    }

    function toggleFullscreen() {
        const fsBtn = document.getElementById('fs-btn');
        
        if (!document.fullscreenElement) {
            document.documentElement.requestFullscreen();
        } else {
            if (document.exitFullscreen) {
                document.exitFullscreen();
            }
        }
    }

    init();
</script>

</body>
</html>
